# gamno v0.3 Предрелизная сборка

Gamno — инструмент для ежедневного чек-ина и анализа решений в desktop-формате.

## О продукте
- Дашборд: сводка 7 дней, сигналы, прогноз индекса.
- История: плотная таблица, детали записи, шаблон для нового чек-ина.
- Оракул: сценарии what-if с картой влияний.
- Граф влияний: редактируемая матрица причинности.
- Настройки: экспорт/импорт/очистка/генерация тестовых данных.


## Живое ядро
- Раздел **Живое ядро** показывает состояние слоя 0: индекс, риск, волатильность, статы (Сила / Интеллект / Мудрость / Ловкость), XP и уровень.
- Снимки состояния сохраняются в IndexedDB после каждого сохранённого чек-ина и после завершения миссии (Dexie таблица `stateSnapshots`).
- В блоке «Почему ядро такое» отображаются топ-3 вкладчика (дельты метрик и вклад текущей миссии).
- Если данных ещё нет, ядро показывает понятный стартовый режим с действиями: создать чек-ин, сгенерировать 30 дней, импортировать данные.


## Цели и гравитация
- Раздел **Цели** добавляет слой «вектор целей»: формулируется активная цель, её горизонт, веса метрик и ограничения риска.
- Панель «Гравитация цели» рассчитывает индекс цели, разрыв до целевого состояния и показывает 3 ключевых фактора, влияющих на траекторию.
- Для активной цели система предлагает 3 лучших действия с ожидаемым изменением индекса и `P(collapse)`, а затем позволяет принять миссию на 3 дня.
- Эффект сценариев Оракула теперь может оцениваться относительно активной цели.

**Дисклеймер:** не медицинская/финансовая рекомендация; модель вероятностная.

## Где хранятся данные
Сборка предназначена для внутреннего тестирования. Данные хранятся локально (IndexedDB).

## Экспорт/импорт
- **Экспорт данных** — выгружает локальную БД в файл `gamno-backup-YYYY-MM-DD.json`.
- **Импорт данных** — восстанавливает БД из файла после подтверждения.
- **Очистить данные** — удаляет локальные данные.

## Тестовые данные
В настройках есть кнопка **Сгенерировать тестовые данные (30 дней)**.
Можно указать Сид (seed) для детерминированной генерации.

## Локальный запуск
```bash
cd app
npm ci
npm run dev
```

## Проверка и сборка
```bash
cd app
npm run build
npm test
```

## Technical note (EN)
- Router: HashRouter (GitHub Pages SPA compatibility).
- Persistence: IndexedDB via Dexie.

## Обучаемая карта влияний (Learned) — что это и ограничения
- Режим **Learned** строит матрицу влияний из истории чек-инов: формируется плотный дневной ряд, пропущенные дни заполняются последним известным значением (forward-fill), затем данные нормализуются (z-score).
- Для каждой целевой метрики обучается ridge-регрессия с лагами 1..L (L = 1..3), а коэффициенты агрегируются в веса связей `i -> j` в диапазоне `[-1, +1]`.
- Параметр регуляризации `alpha` выбирается из фиксированной сетки по walk-forward валидации (минимум MSE).
- В режиме **Mixed** итоговый вес рассчитывается как смесь Manual и Learned по коэффициенту mix `0..1`.
- Поле **Уверенность** отражает стабильность связи на rolling-окнах (например, 30 vs 60 дней) по согласованности знака и близости величины.
- Важно: это **предиктивная модель**, а не доказательство причинно-следственной связи. Используйте результаты как ориентир для гипотез, а не как окончательный факт причинности.


## Мультивселенная: как читать и ограничения
- Раздел **Мультивселенная** моделирует 1 000–10 000 вероятностных траекторий на горизонте 7/14/30 дней с детерминированным `seed`.
- На выходе: fan chart (`p10/p50/p90`) по индексу, вероятности `P(collapse)`/красной Сирены, хвостовые метрики и распределение на горизонте.
- Интерпретация: `p50` — медианный сценарий, `p10` — стресс-квантиль, а панель **Хвост-риск** фокусируется на событиях «хотя бы раз за горизонт».
- Источники неопределённости можно включать/выключать: шум прогноза, шум весов влияния, стохастические переходы режимов (Марковская матрица).
- Ограничения: это вероятностная симуляция и инструмент поддержки решений, а не доказательство причинности. Результаты чувствительны к качеству чек-инов, матрице влияний и выбору плана.

## Чёрные лебеди
- Раздел **Чёрные лебеди** запускает стресс-тест и Monte Carlo «мультивселенную» на 7/14/30 дней с детерминированным `seed`.
- Расчёт выполняется в Web Worker, поэтому интерфейс остаётся отзывчивым даже на 10 000 симуляций.
- На выходе: fan chart индекса (`p10/p50/p90`), гистограмма `P(collapse)`, tail-метрики (`P(ever RED)`, пороги, CVaR/Expected Shortfall) и блок **Margin of Safety** с тремя управляемыми действиями.
- Есть колода готовых стресс-сценариев и локальное хранение пользовательских сценариев/прогонов в IndexedDB.

**Дисклеймеры:**
- Это не медицинская рекомендация.
- Это не доказательство причинности (только вероятностная модель).
- Прогнозирование содержит неопределённость и зависит от качества ваших данных.

## GitHub Pages и локальный режим
- Приложение работает без сервера: локально через `IndexedDB` и `localStorage`.
- Роутинг основан на `HashRouter`, поэтому публикация на GitHub Pages остаётся совместимой.
